<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>List, Query, Manipulate System Processes • ps</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="List, Query, Manipulate System Processes">
<meta property="og:description" content="List, query and manipulate all system processes, on 'Windows',
    'Linux' and 'macOS'.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ps</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/r-lib/ps">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="ps" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ps" class="anchor"></a>ps</h1></div>
<blockquote>
<p>List, Query, Manipulate System Processes</p>
</blockquote>
<p><a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="https://img.shields.io/badge/lifecycle-maturing-blue.svg" alt="lifecycle"></a> <a href="https://travis-ci.org/r-lib/ps"><img src="https://travis-ci.org/r-lib/ps.svg?branch=master" alt="Travis build status"></a> <a href="https://ci.appveyor.com/project/gaborcsardi/ps"><img src="https://ci.appveyor.com/api/projects/status/github/r-lib/ps?branch=master&amp;svg=true" alt="AppVeyor build status"></a> <a href="https://cran.r-project.org/package=ps"><img src="https://www.r-pkg.org/badges/version/ps" alt="CRAN status"></a> <a href="https://www.r-pkg.org/pkg/ps"><img src="https://cranlogs.r-pkg.org/badges/ps" alt="CRAN RStudio mirror downloads"></a> <a href="https://codecov.io/github/r-lib/ps?branch=master"><img src="https://codecov.io/gh/r-lib/ps/branch/master/graph/badge.svg" alt="Coverage status"></a></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>ps implement an API to query and manipulate system processes. Most of its code is based on the <a href="https://github.com/giampaolo/psutil">psutil</a> Python package.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of ps from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">"ps"</span>)</a></code></pre></div>
</div>
<div id="supported-platforms" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-platforms" class="anchor"></a>Supported platforms</h2>
<p>ps currently supports Windows (from Vista), macOS and Linux systems. On unsupported platforms the package can be installed and loaded, but all of its functions fail with an error of class <code>"not_implemented"</code>.</p>
</div>
<div id="listing-all-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#listing-all-processes" class="anchor"></a>Listing all processes</h2>
<p><code><a href="reference/ps_pids.html">ps_pids()</a></code> returns all process ids on the system. This can be useful to iterate over all processes.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(ps)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="reference/ps_pids.html">ps_pids</a></span>()[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</a></code></pre></div>
<pre><code>##  [1]  0  1 48 49 51 52 53 55 58 59 60 61 66 70 72 73 78 79 81 83</code></pre>
<p><code><a href="reference/ps.html">ps()</a></code> returns a data frame (tibble if you have the tibble package available), with data about each process. It contains a handle to each process, in the <code>ps_handle</code> column, you can use these to perform more queries on the processes.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="reference/ps.html">ps</a></span>()</a></code></pre></div>
<pre><code>## # A tibble: 467 x 11
##      pid  ppid name   username status    user  system     rss     vms created             ps_handle
##  * &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dttm&gt;              &lt;I(list)&gt;
##  1 15618 15603 R      gaborcs… runni…  0.743   0.138   1.20e8  2.73e9 2018-11-07 09:38:47 &lt;S3: ps_…
##  2 15603 69354 R      gaborcs… runni…  1.80    0.227   1.21e8  2.69e9 2018-11-07 09:38:42 &lt;S3: ps_…
##  3 15404     1 quick… gaborcs… runni…  0.0578  0.0362  2.86e7  3.09e9 2018-11-07 09:37:38 &lt;S3: ps_…
##  4 15403  9730 Googl… gaborcs… runni…  0.180   0.0634  6.72e7  3.00e9 2018-11-07 09:36:59 &lt;S3: ps_…
##  5 15402  9730 Googl… gaborcs… runni…  0.0836  0.0452  4.94e7  2.97e9 2018-11-07 09:36:58 &lt;S3: ps_…
##  6 15364 15363 docke… gaborcs… runni…  2.05    0.277   3.06e7  2.58e9 2018-11-07 09:34:41 &lt;S3: ps_…
##  7 15363 89645 docke… gaborcs… runni…  0.0482  0.0354  7.84e6  2.53e9 2018-11-07 09:34:41 &lt;S3: ps_…
##  8 15278  9730 Googl… gaborcs… runni…  4.13    1.32    4.80e7  2.80e9 2018-11-07 09:33:51 &lt;S3: ps_…
##  9 15274  9730 Googl… gaborcs… runni… 13.6     1.99    2.29e8  3.22e9 2018-11-07 09:33:43 &lt;S3: ps_…
## 10 15272     1 backu… root     runni… NA      NA      NA      NA      2018-11-07 09:33:24 &lt;S3: ps_…
## # ... with 457 more rows</code></pre>
</div>
<div id="process-api" class="section level2">
<h2 class="hasAnchor">
<a href="#process-api" class="anchor"></a>Process API</h2>
<p>This is a short summary of the API. Please see the documentation of the various methods for details, in particular regarding handles to finished processes and pid reuse. See also “Finished and zombie processes” and “pid reuse” below.</p>
<p><code><a href="reference/ps_handle.html">ps_handle(pid)</a></code> creates a process handle for the supplied process id. If <code>pid</code> is omitted, a handle to the calling process is returned:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">p &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>()</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">p</a></code></pre></div>
<pre><code>## &lt;ps::ps_handle&gt; PID=15618, NAME=R, AT=2018-11-07 09:38:47</code></pre>
<div id="query-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#query-functions" class="anchor"></a>Query functions</h3>
<p><code><a href="reference/ps_pid.html">ps_pid(p)</a></code> returns the pid of the process.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="reference/ps_pid.html">ps_pid</a></span>(p)</a></code></pre></div>
<pre><code>## [1] 15618</code></pre>
<p><code><a href="reference/ps_create_time.html">ps_create_time()</a></code> returns the creation time of the process (according to the OS).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="reference/ps_create_time.html">ps_create_time</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "2018-11-07 09:38:47 GMT"</code></pre>
<p>The process id and the creation time uniquely identify a process in a system. ps uses them to make sure that it reports information about, and manipulates the correct process.</p>
<p><code><a href="reference/ps_is_running.html">ps_is_running(p)</a></code> returns whether <code>p</code> is still running. It handles pid reuse safely.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="reference/ps_is_running.html">ps_is_running</a></span>(p)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><code><a href="reference/ps_ppid.html">ps_ppid(p)</a></code> returns the pid of the parent of <code>p</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="reference/ps_ppid.html">ps_ppid</a></span>(p)</a></code></pre></div>
<pre><code>## [1] 15603</code></pre>
<p><code><a href="reference/ps_ppid.html">ps_parent(p)</a></code> returns a process handle to the parent process of <code>p</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="reference/ps_ppid.html">ps_parent</a></span>(p)</a></code></pre></div>
<pre><code>## &lt;ps::ps_handle&gt; PID=15603, NAME=R, AT=2018-11-07 09:38:42</code></pre>
<p><code><a href="reference/ps_name.html">ps_name(p)</a></code> returns the name of the program <code>p</code> is running.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw"><a href="reference/ps_name.html">ps_name</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "R"</code></pre>
<p><code><a href="reference/ps_exe.html">ps_exe(p)</a></code> returns the full path to the executable the <code>p</code> is running.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="reference/ps_exe.html">ps_exe</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "/Library/Frameworks/R.framework/Versions/3.5/Resources/bin/exec/R"</code></pre>
<p><code><a href="reference/ps_cmdline.html">ps_cmdline(p)</a></code> returns the command line (executable and arguments) of <code>p</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw"><a href="reference/ps_cmdline.html">ps_cmdline</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "/Library/Frameworks/R.framework/Resources/bin/exec/R"                         
## [2] "--slave"                                                                      
## [3] "--no-save"                                                                    
## [4] "--no-restore"                                                                 
## [5] "-f"                                                                           
## [6] "/var/folders/59/0gkmw1yj2w7bf2dfc3jznv5w0000gn/T//RtmppUEiNg/file3cf33c11b009"</code></pre>
<p><code><a href="reference/ps_status.html">ps_status(p)</a></code> returns the status of the process. Possible values are OS dependent, but typically there is <code>"running"</code> and <code>"stopped"</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="reference/ps_status.html">ps_status</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "running"</code></pre>
<p><code><a href="reference/ps_username.html">ps_username(p)</a></code> returns the name of the user the process belongs to.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="reference/ps_username.html">ps_username</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "gaborcsardi"</code></pre>
<p><code><a href="reference/ps_uids.html">ps_uids(p)</a></code> and <code><a href="reference/ps_uids.html">ps_gids(p)</a></code> return the real, effective and saved user ids of the process. They are only implemented on POSIX systems.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="cf">if</span> (<span class="kw"><a href="reference/ps_os_type.html">ps_os_type</a></span>()[[<span class="st">"POSIX"</span>]]) <span class="kw"><a href="reference/ps_uids.html">ps_uids</a></span>(p)</a></code></pre></div>
<pre><code>##      real effective     saved 
##       501       501       501</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="cf">if</span> (<span class="kw"><a href="reference/ps_os_type.html">ps_os_type</a></span>()[[<span class="st">"POSIX"</span>]]) <span class="kw"><a href="reference/ps_uids.html">ps_gids</a></span>(p)</a></code></pre></div>
<pre><code>##      real effective     saved 
##        20        20        20</code></pre>
<p><code><a href="reference/ps_cwd.html">ps_cwd(p)</a></code> returns the current working directory of the process.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="reference/ps_cwd.html">ps_cwd</a></span>(p)</a></code></pre></div>
<pre><code>## [1] "/Users/gaborcsardi/works/ps"</code></pre>
<p><code><a href="reference/ps_terminal.html">ps_terminal(p)</a></code> returns the name of the terminal of the process, if any. For processes without a terminal, and on Windows it returns <code>NA_character_</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw"><a href="reference/ps_terminal.html">ps_terminal</a></span>(p)</a></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p><code><a href="reference/ps_environ.html">ps_environ(p)</a></code> returns the environment variables of the process. <code><a href="reference/ps_environ.html">ps_environ_raw(p)</a></code> does the same, in a different form. Typically they reflect the environment variables at the start of the process.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw"><a href="reference/ps_environ.html">ps_environ</a></span>(p)[<span class="kw">c</span>(<span class="st">"TERM"</span>, <span class="st">"USER"</span>, <span class="st">"SHELL"</span>, <span class="st">"R_HOME"</span>)]</a></code></pre></div>
<pre><code>## TERM                          xterm-256color
## USER                          gaborcsardi
## SHELL                         /bin/zsh
## R_HOME                        /Library/Frameworks/R.framework/Resources</code></pre>
<p><code><a href="reference/ps_num_threads.html">ps_num_threads(p)</a></code> returns the current number of threads of the process.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw"><a href="reference/ps_num_threads.html">ps_num_threads</a></span>(p)</a></code></pre></div>
<pre><code>## [1] 4</code></pre>
<p><code><a href="reference/ps_cpu_times.html">ps_cpu_times(p)</a></code> returns the CPU times of the process, similarly to <code>proc.time()</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw"><a href="reference/ps_cpu_times.html">ps_cpu_times</a></span>(p)</a></code></pre></div>
<pre><code>##            user          system    childen_user children_system 
##       0.9372962       0.1551544              NA              NA</code></pre>
<p><code><a href="reference/ps_memory_info.html">ps_memory_info(p)</a></code> returns memory usage information. See the manual for details.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw"><a href="reference/ps_memory_info.html">ps_memory_info</a></span>(p)</a></code></pre></div>
<pre><code>##        rss        vms    pfaults    pageins 
##  124092416 2703060992      31608        325</code></pre>
<p><code><a href="reference/ps_children.html">ps_children(p)</a></code> lists all child processes (potentially recuirsively) of the current process.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw"><a href="reference/ps_children.html">ps_children</a></span>(<span class="kw"><a href="reference/ps_ppid.html">ps_parent</a></span>(p))</a></code></pre></div>
<pre><code>## [[1]]
## &lt;ps::ps_handle&gt; PID=15618, NAME=R, AT=2018-11-07 09:38:47</code></pre>
<p><code><a href="reference/ps_num_fds.html">ps_num_fds(p)</a></code> returns the number of open file descriptors (handles on Windows):</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw"><a href="reference/ps_num_fds.html">ps_num_fds</a></span>(p)</a></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="kw">file</span>(tmp &lt;-<span class="st"> </span><span class="kw">tempfile</span>(), <span class="st">"w"</span>)</a>
<a class="sourceLine" id="cb48-2" data-line-number="2"><span class="kw"><a href="reference/ps_num_fds.html">ps_num_fds</a></span>(p)</a></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">close</span>(f)</a>
<a class="sourceLine" id="cb50-2" data-line-number="2"><span class="kw">unlink</span>(tmp)</a></code></pre></div>
<p><code><a href="reference/ps_open_files.html">ps_open_files(p)</a></code> lists all open files:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="reference/ps_open_files.html">ps_open_files</a></span>(p)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##      fd path                                                                                
##   &lt;int&gt; &lt;chr&gt;                                                                               
## 1     0 /dev/null                                                                           
## 2     3 /private/var/folders/59/0gkmw1yj2w7bf2dfc3jznv5w0000gn/T/RtmppUEiNg/file3cf33c11b009</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="kw">file</span>(tmp &lt;-<span class="st"> </span><span class="kw">tempfile</span>(), <span class="st">"w"</span>)</a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="kw"><a href="reference/ps_open_files.html">ps_open_files</a></span>(p)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##      fd path                                                                                
##   &lt;int&gt; &lt;chr&gt;                                                                               
## 1     0 /dev/null                                                                           
## 2     3 /private/var/folders/59/0gkmw1yj2w7bf2dfc3jznv5w0000gn/T/RtmppUEiNg/file3cf33c11b009
## 3     4 /private/var/folders/59/0gkmw1yj2w7bf2dfc3jznv5w0000gn/T/Rtmp5G3HjH/file3d0222d724a8</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw">close</span>(f)</a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">unlink</span>(tmp)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw"><a href="reference/ps_open_files.html">ps_open_files</a></span>(p)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##      fd path                                                                                
##   &lt;int&gt; &lt;chr&gt;                                                                               
## 1     0 /dev/null                                                                           
## 2     3 /private/var/folders/59/0gkmw1yj2w7bf2dfc3jznv5w0000gn/T/RtmppUEiNg/file3cf33c11b009</code></pre>
</div>
<div id="process-manipulation" class="section level3">
<h3 class="hasAnchor">
<a href="#process-manipulation" class="anchor"></a>Process manipulation</h3>
<p><code><a href="reference/ps_suspend.html">ps_suspend(p)</a></code> suspends (stops) the process. On POSIX it sends a SIGSTOP signal. On Windows it stops all threads.</p>
<p><code><a href="reference/ps_resume.html">ps_resume(p)</a></code> resumes the process. On POSIX it sends a SIGCONT signal. On Windows it resumes all stopped threads.</p>
<p><code><a href="reference/ps_send_signal.html">ps_send_signal(p)</a></code> sends a signal to the process. It is implemented on POSIX systems only. It makes an effort to work around pid reuse.</p>
<p><code><a href="reference/ps_terminate.html">ps_terminate(p)</a></code> send SIGTERM to the process. On POSIX systems only.</p>
<p><code><a href="reference/ps_kill.html">ps_kill(p)</a></code> terminates the process. Sends <code>SIGKILL</code> on POSIX systems, uses <code>TerminateProcess()</code> on Windows. It make an effort to work around pid reuse.</p>
<p><code><a href="reference/ps_interrupt.html">ps_interrupt(p)</a></code> interrupts a process. It sends a <code>SIGINT</code> signal on POSIX systems, and it can send a CTRL+C or a CTRL+BREAK event on Windows.</p>
</div>
</div>
<div id="finished-and-zombie-processes" class="section level2">
<h2 class="hasAnchor">
<a href="#finished-and-zombie-processes" class="anchor"></a>Finished and zombie processes</h2>
<p>ps handles finished and Zombie processes as much as possible.</p>
<p>The essential <code><a href="reference/ps_pid.html">ps_pid()</a></code>, <code><a href="reference/ps_create_time.html">ps_create_time()</a></code>, <code><a href="reference/ps_is_running.html">ps_is_running()</a></code> functions and the <code>format()</code> and <code>print()</code> methods work for all processes, including finished and zombie processes. Other functions fail with an error of class <code>"no_such_process"</code> for finished processes.</p>
<p>The <code><a href="reference/ps_ppid.html">ps_ppid()</a></code>, <code><a href="reference/ps_ppid.html">ps_parent()</a></code>, <code><a href="reference/ps_children.html">ps_children()</a></code>, <code><a href="reference/ps_name.html">ps_name()</a></code>, <code><a href="reference/ps_status.html">ps_status()</a></code>, <code><a href="reference/ps_username.html">ps_username()</a></code>, <code><a href="reference/ps_uids.html">ps_uids()</a></code>, <code><a href="reference/ps_uids.html">ps_gids()</a></code>, <code><a href="reference/ps_terminal.html">ps_terminal()</a></code>, <code><a href="reference/ps_children.html">ps_children()</a></code> and the signal sending functions work properly for zombie processes. Other functions fail with <code>"zombie_process"</code> error.</p>
</div>
<div id="pid-reuse" class="section level2">
<h2 class="hasAnchor">
<a href="#pid-reuse" class="anchor"></a>Pid reuse</h2>
<p>ps functions handle pid reuse as well as technically possible.</p>
<p>The query functions never return information about the wrong process, even if the process has finished and its process id was re-assigned.</p>
<p>On Windows, the process manipulation functions never manipulate the wrong process.</p>
<p>On POSIX systems, this is technically impossible, it is not possible to send a signal to a process without creating a race condition. In ps the time window of the race condition is very small, a few microseconds, and the process would need to finish, <em>and</em> the OS would need to reuse its pid within this time window to create problems. This is very unlikely to happen.</p>
</div>
<div id="recipes" class="section level2">
<h2 class="hasAnchor">
<a href="#recipes" class="anchor"></a>Recipes</h2>
<p>In the spirit of <a href="http://psutil.readthedocs.io/en/latest/#recipes">psutil recipes</a>.</p>
<div id="find-process-by-name" class="section level3">
<h3 class="hasAnchor">
<a href="#find-process-by-name" class="anchor"></a>Find process by name</h3>
<p>Using <code><a href="reference/ps.html">ps()</a></code> and dplyr:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">find_procs_by_name &lt;-<span class="st"> </span><span class="cf">function</span>(name) {</a>
<a class="sourceLine" id="cb57-3" data-line-number="3">  <span class="kw"><a href="reference/ps.html">ps</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(name <span class="op">==</span><span class="st"> </span><span class="op">!!</span>name)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/pull.html">pull</a></span>(ps_handle)</a>
<a class="sourceLine" id="cb57-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb57-7" data-line-number="7"></a>
<a class="sourceLine" id="cb57-8" data-line-number="8"><span class="kw">find_procs_by_name</span>(<span class="st">"R"</span>)</a></code></pre></div>
<pre><code>## [[1]]
## &lt;ps::ps_handle&gt; PID=15618, NAME=R, AT=2018-11-07 09:38:47
## 
## [[2]]
## &lt;ps::ps_handle&gt; PID=15603, NAME=R, AT=2018-11-07 09:38:42
## 
## [[3]]
## &lt;ps::ps_handle&gt; PID=12255, NAME=R, AT=2018-11-06 16:01:03
## 
## [[4]]
## &lt;ps::ps_handle&gt; PID=3382, NAME=R, AT=2018-11-06 14:11:26
## 
## [[5]]
## &lt;ps::ps_handle&gt; PID=91047, NAME=R, AT=2018-11-06 12:09:09
## 
## [[6]]
## &lt;ps::ps_handle&gt; PID=71838, NAME=R, AT=2018-11-06 09:42:47
## 
## [[7]]
## &lt;ps::ps_handle&gt; PID=70692, NAME=R, AT=2018-11-06 09:42:20
## 
## [[8]]
## &lt;ps::ps_handle&gt; PID=69968, NAME=R, AT=2018-11-06 09:42:12
## 
## [[9]]
## &lt;ps::ps_handle&gt; PID=69526, NAME=R, AT=2018-11-06 09:42:03
## 
## [[10]]
## &lt;ps::ps_handle&gt; PID=69354, NAME=R, AT=2018-11-06 09:41:52
## 
## [[11]]
## &lt;ps::ps_handle&gt; PID=67847, NAME=R, AT=2018-11-06 00:45:09
## 
## [[12]]
## &lt;ps::ps_handle&gt; PID=66306, NAME=R, AT=2018-11-05 23:54:25
## 
## [[13]]
## &lt;ps::ps_handle&gt; PID=84819, NAME=R, AT=2018-11-05 16:05:40
## 
## [[14]]
## &lt;ps::ps_handle&gt; PID=84694, NAME=R, AT=2018-11-05 16:05:37</code></pre>
<p>Without creating the full table of processes:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">find_procs_by_name &lt;-<span class="st"> </span><span class="cf">function</span>(name) {</a>
<a class="sourceLine" id="cb59-2" data-line-number="2">  procs &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw"><a href="reference/ps_pids.html">ps_pids</a></span>(), <span class="cf">function</span>(p) {</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">    <span class="kw">tryCatch</span>({</a>
<a class="sourceLine" id="cb59-4" data-line-number="4">      h &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(p)</a>
<a class="sourceLine" id="cb59-5" data-line-number="5">      <span class="cf">if</span> (<span class="kw"><a href="reference/ps_name.html">ps_name</a></span>(h) <span class="op">==</span><span class="st"> </span>name) h <span class="cf">else</span> <span class="ot">NULL</span> },</a>
<a class="sourceLine" id="cb59-6" data-line-number="6">      <span class="dt">no_such_process =</span> <span class="cf">function</span>(e) <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb59-7" data-line-number="7">      <span class="dt">access_denied =</span> <span class="cf">function</span>(e) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb59-8" data-line-number="8">    )</a>
<a class="sourceLine" id="cb59-9" data-line-number="9">  })</a>
<a class="sourceLine" id="cb59-10" data-line-number="10">  procs[<span class="op">!</span><span class="kw">vapply</span>(procs, is.null, <span class="kw">logical</span>(<span class="dv">1</span>))]</a>
<a class="sourceLine" id="cb59-11" data-line-number="11">  }</a>
<a class="sourceLine" id="cb59-12" data-line-number="12"></a>
<a class="sourceLine" id="cb59-13" data-line-number="13"><span class="kw">find_procs_by_name</span>(<span class="st">"R"</span>)</a></code></pre></div>
<pre><code>## [[1]]
## &lt;ps::ps_handle&gt; PID=3382, NAME=R, AT=2018-11-06 14:11:26
## 
## [[2]]
## &lt;ps::ps_handle&gt; PID=12255, NAME=R, AT=2018-11-06 16:01:03
## 
## [[3]]
## &lt;ps::ps_handle&gt; PID=15603, NAME=R, AT=2018-11-07 09:38:42
## 
## [[4]]
## &lt;ps::ps_handle&gt; PID=15618, NAME=R, AT=2018-11-07 09:38:47
## 
## [[5]]
## &lt;ps::ps_handle&gt; PID=66306, NAME=R, AT=2018-11-05 23:54:25
## 
## [[6]]
## &lt;ps::ps_handle&gt; PID=67847, NAME=R, AT=2018-11-06 00:45:09
## 
## [[7]]
## &lt;ps::ps_handle&gt; PID=69354, NAME=R, AT=2018-11-06 09:41:52
## 
## [[8]]
## &lt;ps::ps_handle&gt; PID=69526, NAME=R, AT=2018-11-06 09:42:03
## 
## [[9]]
## &lt;ps::ps_handle&gt; PID=69968, NAME=R, AT=2018-11-06 09:42:12
## 
## [[10]]
## &lt;ps::ps_handle&gt; PID=70692, NAME=R, AT=2018-11-06 09:42:20
## 
## [[11]]
## &lt;ps::ps_handle&gt; PID=71838, NAME=R, AT=2018-11-06 09:42:47
## 
## [[12]]
## &lt;ps::ps_handle&gt; PID=84694, NAME=R, AT=2018-11-05 16:05:37
## 
## [[13]]
## &lt;ps::ps_handle&gt; PID=84819, NAME=R, AT=2018-11-05 16:05:40
## 
## [[14]]
## &lt;ps::ps_handle&gt; PID=91047, NAME=R, AT=2018-11-06 12:09:09</code></pre>
</div>
<div id="wait-for-a-process-to-finish" class="section level3">
<h3 class="hasAnchor">
<a href="#wait-for-a-process-to-finish" class="anchor"></a>Wait for a process to finish</h3>
<p>On POSIX, there is no good way to wait for non-child processes to finish, so we need to write a sleep-wait loop to do it. (On Windows, and BSD systems, including macOS, there are better solutions.)</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">as_secs &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">as.numeric</span>(x, <span class="dt">units =</span> <span class="st">"secs"</span>)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2"></a>
<a class="sourceLine" id="cb61-3" data-line-number="3">wait_for_process &lt;-<span class="st"> </span><span class="cf">function</span>(proc, <span class="dt">timeout =</span> <span class="ot">Inf</span>, <span class="dt">sleep =</span> <span class="fl">0.1</span>) {</a>
<a class="sourceLine" id="cb61-4" data-line-number="4">  sleep &lt;-<span class="st"> </span><span class="kw">as_secs</span>(sleep)</a>
<a class="sourceLine" id="cb61-5" data-line-number="5">  deadline &lt;-<span class="st"> </span><span class="kw">Sys.time</span>() <span class="op">+</span><span class="st"> </span>timeout</a>
<a class="sourceLine" id="cb61-6" data-line-number="6">  <span class="cf">while</span> (<span class="kw"><a href="reference/ps_is_running.html">ps_is_running</a></span>(proc) <span class="op">&amp;&amp;</span><span class="st"> </span>(timeout <span class="op">==</span><span class="st"> </span><span class="ot">Inf</span> <span class="op">||</span><span class="st"> </span><span class="kw">Sys.time</span>() <span class="op">&lt;</span><span class="st"> </span>deadline)) {</a>
<a class="sourceLine" id="cb61-7" data-line-number="7">    to &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">as_secs</span>(deadline <span class="op">-</span><span class="st"> </span><span class="kw">Sys.time</span>()), sleep)</a>
<a class="sourceLine" id="cb61-8" data-line-number="8">    <span class="kw">Sys.sleep</span>(to)</a>
<a class="sourceLine" id="cb61-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb61-10" data-line-number="10">  <span class="op">!</span><span class="st"> </span><span class="kw"><a href="reference/ps_is_running.html">ps_is_running</a></span>(proc)</a>
<a class="sourceLine" id="cb61-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb61-12" data-line-number="12"></a>
<a class="sourceLine" id="cb61-13" data-line-number="13">px &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"2"</span>)</a>
<a class="sourceLine" id="cb61-14" data-line-number="14">p &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(px<span class="op">$</span><span class="kw">get_pid</span>())</a>
<a class="sourceLine" id="cb61-15" data-line-number="15"><span class="kw">wait_for_process</span>(p, <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">wait_for_process</span>(p)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="wait-for-several-processes-to-finish" class="section level3">
<h3 class="hasAnchor">
<a href="#wait-for-several-processes-to-finish" class="anchor"></a>Wait for several processes to finish</h3>
<p>This is similar, but we need to wait on all processes in a loop.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">wait_for_processes &lt;-<span class="st"> </span><span class="cf">function</span>(procs, <span class="dt">timeout =</span> <span class="ot">Inf</span>) {</a>
<a class="sourceLine" id="cb65-2" data-line-number="2">  gone &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb65-3" data-line-number="3">  alive &lt;-<span class="st"> </span>procs</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">  deadline &lt;-<span class="st"> </span><span class="kw">Sys.time</span>() <span class="op">+</span><span class="st"> </span>timeout</a>
<a class="sourceLine" id="cb65-5" data-line-number="5"></a>
<a class="sourceLine" id="cb65-6" data-line-number="6">  check_gone &lt;-<span class="st"> </span><span class="cf">function</span>(proc, timeout) {</a>
<a class="sourceLine" id="cb65-7" data-line-number="7">    proc_gone &lt;-<span class="st"> </span><span class="kw">wait_for_process</span>(proc, <span class="dt">timeout =</span> timeout)</a>
<a class="sourceLine" id="cb65-8" data-line-number="8">    <span class="cf">if</span> (proc_gone) {</a>
<a class="sourceLine" id="cb65-9" data-line-number="9">      gone &lt;&lt;-<span class="st"> </span><span class="kw">c</span>(gone, <span class="kw">list</span>(proc))</a>
<a class="sourceLine" id="cb65-10" data-line-number="10">      alive &lt;&lt;-<span class="st"> </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/setops.html">setdiff</a></span>(alive, <span class="kw">list</span>(proc))</a>
<a class="sourceLine" id="cb65-11" data-line-number="11">    }</a>
<a class="sourceLine" id="cb65-12" data-line-number="12">  }</a>
<a class="sourceLine" id="cb65-13" data-line-number="13"></a>
<a class="sourceLine" id="cb65-14" data-line-number="14">  <span class="cf">while</span> (<span class="kw">length</span>(alive)) {</a>
<a class="sourceLine" id="cb65-15" data-line-number="15">    <span class="cf">if</span> (timeout <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="cf">break</span></a>
<a class="sourceLine" id="cb65-16" data-line-number="16">    <span class="cf">for</span> (proc <span class="cf">in</span> alive) {</a>
<a class="sourceLine" id="cb65-17" data-line-number="17">      max_timeout &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">length</span>(alive)</a>
<a class="sourceLine" id="cb65-18" data-line-number="18">      <span class="cf">if</span> (timeout <span class="op">!=</span><span class="st"> </span><span class="ot">Inf</span>) {</a>
<a class="sourceLine" id="cb65-19" data-line-number="19">        timeout &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">as_secs</span>(deadline <span class="op">-</span><span class="st"> </span><span class="kw">Sys.time</span>()), max_timeout)</a>
<a class="sourceLine" id="cb65-20" data-line-number="20">        <span class="cf">if</span> (timeout <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="cf">break</span></a>
<a class="sourceLine" id="cb65-21" data-line-number="21">        <span class="kw">check_gone</span>(proc, timeout)</a>
<a class="sourceLine" id="cb65-22" data-line-number="22">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb65-23" data-line-number="23">        <span class="kw">check_gone</span>(proc, max_timeout)</a>
<a class="sourceLine" id="cb65-24" data-line-number="24">      }</a>
<a class="sourceLine" id="cb65-25" data-line-number="25">    }</a>
<a class="sourceLine" id="cb65-26" data-line-number="26">  }</a>
<a class="sourceLine" id="cb65-27" data-line-number="27">  <span class="kw">list</span>(<span class="dt">gone =</span> gone, <span class="dt">alive =</span> alive)</a>
<a class="sourceLine" id="cb65-28" data-line-number="28">}</a>
<a class="sourceLine" id="cb65-29" data-line-number="29"></a>
<a class="sourceLine" id="cb65-30" data-line-number="30">px1 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"10"</span>)</a>
<a class="sourceLine" id="cb65-31" data-line-number="31">px2 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"10"</span>)</a>
<a class="sourceLine" id="cb65-32" data-line-number="32">px3 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"1"</span>)</a>
<a class="sourceLine" id="cb65-33" data-line-number="33">px4 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"1"</span>)</a>
<a class="sourceLine" id="cb65-34" data-line-number="34"></a>
<a class="sourceLine" id="cb65-35" data-line-number="35">p1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(px1<span class="op">$</span><span class="kw">get_pid</span>())</a>
<a class="sourceLine" id="cb65-36" data-line-number="36">p2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(px2<span class="op">$</span><span class="kw">get_pid</span>())</a>
<a class="sourceLine" id="cb65-37" data-line-number="37">p3 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(px3<span class="op">$</span><span class="kw">get_pid</span>())</a>
<a class="sourceLine" id="cb65-38" data-line-number="38">p4 &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(px4<span class="op">$</span><span class="kw">get_pid</span>())</a>
<a class="sourceLine" id="cb65-39" data-line-number="39"></a>
<a class="sourceLine" id="cb65-40" data-line-number="40"><span class="kw">wait_for_processes</span>(<span class="kw">list</span>(p1, p2, p3, p4), <span class="dt">timeout =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## $gone
## $gone[[1]]
## &lt;ps::ps_handle&gt; PID=15634, NAME=???, AT=2018-11-07 09:38:51
## 
## $gone[[2]]
## &lt;ps::ps_handle&gt; PID=15633, NAME=???, AT=2018-11-07 09:38:51
## 
## 
## $alive
## $alive[[1]]
## &lt;ps::ps_handle&gt; PID=15631, NAME=sleep, AT=2018-11-07 09:38:51
## 
## $alive[[2]]
## &lt;ps::ps_handle&gt; PID=15632, NAME=sleep, AT=2018-11-07 09:38:51</code></pre>
</div>
<div id="kill-process-tree" class="section level3">
<h3 class="hasAnchor">
<a href="#kill-process-tree" class="anchor"></a>Kill process tree</h3>
<p>This sends a signal, so it’ll only work on Unix. Use <code><a href="reference/ps_kill.html">ps_kill()</a></code> instead of <code><a href="reference/ps_send_signal.html">ps_send_signal()</a></code> on Windows.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">kill_proc_tree &lt;-<span class="st"> </span><span class="cf">function</span>(pid, <span class="dt">sig =</span> <span class="kw"><a href="reference/signals.html">signals</a></span>()<span class="op">$</span>SIGTERM,</a>
<a class="sourceLine" id="cb67-2" data-line-number="2">                           <span class="dt">include_parent =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb67-3" data-line-number="3">  <span class="cf">if</span> (pid <span class="op">==</span><span class="st"> </span><span class="kw">Sys.getpid</span>() <span class="op">&amp;&amp;</span><span class="st"> </span>include_parent) <span class="kw">stop</span>(<span class="st">"I refuse to kill myself"</span>)</a>
<a class="sourceLine" id="cb67-4" data-line-number="4">  parent &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>(pid)</a>
<a class="sourceLine" id="cb67-5" data-line-number="5">  children &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_children.html">ps_children</a></span>(parent, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb67-6" data-line-number="6">  <span class="cf">if</span> (include_parent) children &lt;-<span class="st"> </span><span class="kw">c</span>(children, parent)</a>
<a class="sourceLine" id="cb67-7" data-line-number="7">  <span class="cf">for</span> (p <span class="cf">in</span> children) <span class="kw"><a href="reference/ps_send_signal.html">ps_send_signal</a></span>(p, sig)</a>
<a class="sourceLine" id="cb67-8" data-line-number="8">  <span class="kw">wait_for_processes</span>(children, <span class="dt">timeout =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb67-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb67-10" data-line-number="10"></a>
<a class="sourceLine" id="cb67-11" data-line-number="11">p1 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"10"</span>)</a>
<a class="sourceLine" id="cb67-12" data-line-number="12">p2 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"10"</span>)</a>
<a class="sourceLine" id="cb67-13" data-line-number="13">p3 &lt;-<span class="st"> </span>processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"10"</span>)</a>
<a class="sourceLine" id="cb67-14" data-line-number="14"><span class="kw">kill_proc_tree</span>(<span class="kw">Sys.getpid</span>(), <span class="dt">include_parent =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## $gone
## $gone[[1]]
## &lt;ps::ps_handle&gt; PID=15631, NAME=???, AT=2018-11-07 09:38:51
## 
## $gone[[2]]
## &lt;ps::ps_handle&gt; PID=15632, NAME=???, AT=2018-11-07 09:38:51
## 
## $gone[[3]]
## &lt;ps::ps_handle&gt; PID=15635, NAME=???, AT=2018-11-07 09:38:53
## 
## $gone[[4]]
## &lt;ps::ps_handle&gt; PID=15636, NAME=???, AT=2018-11-07 09:38:53
## 
## $gone[[5]]
## &lt;ps::ps_handle&gt; PID=15637, NAME=???, AT=2018-11-07 09:38:53
## 
## 
## $alive
## list()</code></pre>
</div>
<div id="terminate-children" class="section level3">
<h3 class="hasAnchor">
<a href="#terminate-children" class="anchor"></a>Terminate children</h3>
<p>Note, that some R IDEs, including RStudio, run a multithreaded R process, and other threads may start processes as well. <code>reap_children()</code> will clean up all these as well, potentially causing the IDE to misbehave or crash.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">reap_children &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">timeout =</span> <span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb69-2" data-line-number="2">  procs &lt;-<span class="st"> </span><span class="kw"><a href="reference/ps_children.html">ps_children</a></span>(<span class="kw"><a href="reference/ps_handle.html">ps_handle</a></span>())</a>
<a class="sourceLine" id="cb69-3" data-line-number="3"></a>
<a class="sourceLine" id="cb69-4" data-line-number="4">  ## SIGTERM</a>
<a class="sourceLine" id="cb69-5" data-line-number="5">  <span class="kw">lapply</span>(procs, ps_terminate)</a>
<a class="sourceLine" id="cb69-6" data-line-number="6"></a>
<a class="sourceLine" id="cb69-7" data-line-number="7">  ga &lt;-<span class="st"> </span><span class="kw">wait_for_processes</span>(procs, <span class="dt">timeout =</span> timeout)</a>
<a class="sourceLine" id="cb69-8" data-line-number="8"></a>
<a class="sourceLine" id="cb69-9" data-line-number="9">  ## SIGKILL to the survivers</a>
<a class="sourceLine" id="cb69-10" data-line-number="10">  <span class="cf">if</span> (<span class="kw">length</span>(ga<span class="op">$</span>alive)) <span class="kw">lapply</span>(ga<span class="op">$</span>alive, ps_kill)</a>
<a class="sourceLine" id="cb69-11" data-line-number="11"></a>
<a class="sourceLine" id="cb69-12" data-line-number="12">  ga2 &lt;-<span class="st"> </span><span class="kw">wait_for_processes</span>(ga<span class="op">$</span>alive, <span class="dt">timeout =</span> timeout)</a>
<a class="sourceLine" id="cb69-13" data-line-number="13"></a>
<a class="sourceLine" id="cb69-14" data-line-number="14">  ## Some might still survive</a>
<a class="sourceLine" id="cb69-15" data-line-number="15">  <span class="kw">list</span>(<span class="dt">gone =</span> <span class="kw">c</span>(ga<span class="op">$</span>gone, ga2<span class="op">$</span>gone), <span class="dt">alive =</span> ga2<span class="op">$</span>alive)</a>
<a class="sourceLine" id="cb69-16" data-line-number="16">}</a>
<a class="sourceLine" id="cb69-17" data-line-number="17"></a>
<a class="sourceLine" id="cb69-18" data-line-number="18">pxs &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">3</span>, processx<span class="op">::</span>process<span class="op">$</span><span class="kw">new</span>(<span class="st">"sleep"</span>, <span class="st">"3"</span>))</a>
<a class="sourceLine" id="cb69-19" data-line-number="19"><span class="kw">reap_children</span>()</a></code></pre></div>
<pre><code>## $gone
## $gone[[1]]
## &lt;ps::ps_handle&gt; PID=15638, NAME=???, AT=2018-11-07 09:38:53
## 
## $gone[[2]]
## &lt;ps::ps_handle&gt; PID=15639, NAME=???, AT=2018-11-07 09:38:53
## 
## $gone[[3]]
## &lt;ps::ps_handle&gt; PID=15640, NAME=???, AT=2018-11-07 09:38:53
## 
## 
## $alive
## list()</code></pre>
</div>
<div id="filtering-and-sorting-processes" class="section level3">
<h3 class="hasAnchor">
<a href="#filtering-and-sorting-processes" class="anchor"></a>Filtering and sorting processes</h3>
<p>Process name ending with “sh”:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw"><a href="reference/ps.html">ps</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw">grepl</span>(<span class="st">"sh$"</span>, name))</a></code></pre></div>
<pre><code>## # A tibble: 44 x 11
##      pid  ppid name  username  status     user  system    rss    vms created             ps_handle 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;              &lt;I(list)&gt; 
##  1 12161 12155 zsh   gaborcsa… running 0.00637 0.0125  1.16e6 2.53e9 2018-11-06 16:00:56 &lt;S3: ps_h…
##  2 12155 12154 zsh   gaborcsa… running 0.296   0.186   2.23e6 2.53e9 2018-11-06 16:00:56 &lt;S3: ps_h…
##  3  3590  3574 zsh   gaborcsa… running 0.00649 0.0113  1.16e6 2.53e9 2018-11-06 14:11:36 &lt;S3: ps_h…
##  4  3574  3571 zsh   gaborcsa… running 0.267   0.126   2.22e6 2.53e9 2018-11-06 14:11:36 &lt;S3: ps_h…
##  5  3337  3331 zsh   gaborcsa… running 0.00403 0.00615 1.16e6 2.53e9 2018-11-06 14:11:26 &lt;S3: ps_h…
##  6  3331  3330 zsh   gaborcsa… running 0.230   0.109   2.22e6 2.53e9 2018-11-06 14:11:25 &lt;S3: ps_h…
##  7  1283  1277 zsh   gaborcsa… running 0.0353  0.0771  1.16e6 2.53e9 2018-11-06 13:58:53 &lt;S3: ps_h…
##  8  1277  1276 zsh   gaborcsa… running 0.749   0.411   2.23e6 2.53e9 2018-11-06 13:58:53 &lt;S3: ps_h…
##  9 71793 71787 zsh   gaborcsa… running 0.00449 0.00680 1.16e6 2.53e9 2018-11-06 09:42:47 &lt;S3: ps_h…
## 10 71787 71786 zsh   gaborcsa… running 0.229   0.111   2.22e6 2.53e9 2018-11-06 09:42:46 &lt;S3: ps_h…
## # ... with 34 more rows</code></pre>
<p>Processes owned by user:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw"><a href="reference/ps.html">ps</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(username <span class="op">==</span><span class="st"> </span><span class="kw">Sys.info</span>()[[<span class="st">"user"</span>]]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(pid, name)</a></code></pre></div>
<pre><code>## # A tibble: 330 x 2
##      pid name                
##    &lt;int&gt; &lt;chr&gt;               
##  1 15618 R                   
##  2 15603 R                   
##  3 15404 quicklookd          
##  4 15402 Google Chrome Helper
##  5 15364 docker-compose      
##  6 15363 docker-compose      
##  7 15278 Google Chrome Helper
##  8 15274 Google Chrome Helper
##  9 15048 Google Chrome Helper
## 10 15046 Google Chrome Helper
## # ... with 320 more rows</code></pre>
<p>Processes consuming more than 100MB of memory:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw"><a href="reference/ps.html">ps</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(rss <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span> <span class="op">*</span><span class="st"> </span><span class="dv">1024</span> <span class="op">*</span><span class="st"> </span><span class="dv">1024</span>)</a></code></pre></div>
<pre><code>## # A tibble: 21 x 11
##      pid  ppid name     username  status   user system    rss    vms created             ps_handle 
##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;              &lt;I(list)&gt; 
##  1 15618 15603 R        gaborcsa… running  1.67  0.459 1.27e8 2.70e9 2018-11-07 09:38:47 &lt;S3: ps_h…
##  2 15603 69354 R        gaborcsa… running  1.82  0.230 1.21e8 2.69e9 2018-11-07 09:38:42 &lt;S3: ps_h…
##  3 15274  9730 Google … gaborcsa… running 14.1   2.02  2.26e8 3.22e9 2018-11-07 09:33:43 &lt;S3: ps_h…
##  4 15048  9730 Google … gaborcsa… running  1.93  0.328 1.25e8 3.06e9 2018-11-07 09:05:18 &lt;S3: ps_h…
##  5 14908 14899 Slack H… gaborcsa… running 47.1   5.88  5.38e8 4.18e9 2018-11-07 08:07:41 &lt;S3: ps_h…
##  6 14907 14899 Slack H… gaborcsa… running  9.06  2.02  1.35e8 3.63e9 2018-11-07 08:07:40 &lt;S3: ps_h…
##  7 14905 14899 Slack H… gaborcsa… running  9.21  0.865 2.95e8 3.83e9 2018-11-07 08:07:40 &lt;S3: ps_h…
##  8 14904 14899 Slack H… gaborcsa… running  8.11  0.761 3.01e8 3.83e9 2018-11-07 08:07:40 &lt;S3: ps_h…
##  9 14903 14899 Slack H… gaborcsa… running 19.5   2.88  3.93e8 3.98e9 2018-11-07 08:07:40 &lt;S3: ps_h…
## 10 14900 14899 Slack H… gaborcsa… running 12.8  13.3   3.45e8 3.38e9 2018-11-07 08:07:39 &lt;S3: ps_h…
## # ... with 11 more rows</code></pre>
<p>Top 3 memory consuming processes:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw"><a href="reference/ps.html">ps</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="dv">3</span>, rss) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(rss))</a></code></pre></div>
<pre><code>## # A tibble: 3 x 11
##     pid  ppid name     username  status    user system    rss    vms created             ps_handle 
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dttm&gt;              &lt;I(list)&gt; 
## 1 64244     1 iTerm2   gaborcsa… running 2.93e4 1.90e3 6.71e8 5.31e9 2018-10-30 08:48:09 &lt;S3: ps_h…
## 2 14908 14899 Slack H… gaborcsa… running 4.71e1 5.88e0 5.38e8 4.18e9 2018-11-07 08:07:41 &lt;S3: ps_h…
## 3 67519  9730 Google … gaborcsa… running 6.83e2 8.54e1 5.19e8 3.91e9 2018-11-06 00:23:50 &lt;S3: ps_h…</code></pre>
<p>Top 3 processes which consumed the most CPU time:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw"><a href="reference/ps.html">ps</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">cpu_time =</span> user <span class="op">+</span><span class="st"> </span>system) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/top_n.html">top_n</a></span>(<span class="dv">3</span>, cpu_time) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(cpu_time)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(pid, name, cpu_time)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##     pid name                cpu_time
##   &lt;int&gt; &lt;chr&gt;                  &lt;dbl&gt;
## 1   516 com.docker.hyperkit  130929.
## 2 64244 iTerm2                31230.
## 3  9730 Google Chrome         22743.</code></pre>
</div>
</div>
<div id="contributions" class="section level2">
<h2 class="hasAnchor">
<a href="#contributions" class="anchor"></a>Contributions</h2>
<p>Please note that this project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>BSD © RStudio</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=ps">https://​cloud.r-project.org/​package=ps</a>
</li>
<li>Browse source code at <br><a href="https://github.com/r-lib/ps">https://​github.com/​r-lib/​ps</a>
</li>
<li>Report a bug at <br><a href="https://github.com/r-lib/ps/issues">https://​github.com/​r-lib/​ps/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jay Loden <br><small class="roles"> Author </small>  </li>
<li>Dave Daeschler <br><small class="roles"> Author </small>  </li>
<li>Giampaolo Rodola' <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://github.com/gaborcsardi">Gábor Csárdi</a> <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jay Loden, Dave Daeschler, Giampaolo Rodola', <a href="https://github.com/gaborcsardi">Gábor Csárdi</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
